<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-GW8EJHVZ6P","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="Grid AI" href="/opensearch.xml">
<script src="/js/termynal.js"></script>
<script src="/js/main.js"></script><title data-react-helmet="true">Text Classification | Grid AI</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://docs.grid.ai/examples/nlp/text-classification"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Text Classification | Grid AI"><meta data-react-helmet="true" name="description" content="Tutorial shows how to train a sentiment analysis model using Grid and Lightning Flash"><meta data-react-helmet="true" property="og:description" content="Tutorial shows how to train a sentiment analysis model using Grid and Lightning Flash"><link data-react-helmet="true" rel="icon" href="/images/logos/favicon-32x32.png"><link data-react-helmet="true" rel="canonical" href="https://docs.grid.ai/examples/nlp/text-classification"><link data-react-helmet="true" rel="alternate" href="https://docs.grid.ai/examples/nlp/text-classification" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.grid.ai/examples/nlp/text-classification" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://ZQJPKPI662-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.4da5a155.css">
<link rel="preload" href="/assets/js/runtime~main.007a586e.js" as="script">
<link rel="preload" href="/assets/js/main.5ecc84b8.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><div class="announcementBar_axC9" role="banner"><div class="announcementBarPlaceholder_xYHE"></div><div class="announcementBarContent_6uhP">Welcome to the new and improved Grid Documentation site!</div><button type="button" class="clean-btn close announcementBarClose_A3A1" aria-label="Close"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/images/logos/grid-logo-light.png" alt="Grid AI Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/images/logos/grid-logo-dark.png" alt="Grid AI Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title"></b></a><a class="navbar__item navbar__link" href="/platform/changelog">Changelog</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/products/runs">Runs</a><a class="navbar__item navbar__link" href="/products/sessions">Sessions</a><a class="navbar__item navbar__link" href="/products/add-data-to-grid-datastores">Datastores</a><a href="https://platform.grid.ai" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Platform<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="searchBox_Utm0"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><main class="docMainContainer_r8cw docMainContainerEnhanced_SOUu"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Text Classification</h1></header><h2 class="anchor anchorWithStickyNavbar_y2LR" id="goal">Goal<a class="hash-link" href="#goal" title="Direct link to heading">â€‹</a></h2><p>This example covers a text classification deep learning task</p><ol><li>Create a Datastore</li><li>Start new Run</li><li>Visualize Metrics</li><li>Download Artifacts</li></ol><p>Tutorial time: 5 minutes</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="overview">Overview<a class="hash-link" href="#overview" title="Direct link to heading">â€‹</a></h2><p>Classifying text is a deep learning task that represents a class of problems such as sentiment analysis: predicting the sentiment of tweets and movie reviews or customer sentiment regarding a product as well as classifying email as spam or not.</p><p>This example uses the Transformers model <!-- -->(<!-- -->bert-base-uncased<!-- -->)<!-- --> from <a href="https://huggingface.co/bert-base-uncased" target="_blank" rel="noopener noreferrer">huggingface repository</a>, it is adapted to use PyTorch Lightning, <a href="https://github.com/gridai/grid-text-classification" target="_blank" rel="noopener noreferrer">https://github.com/gridai/grid-text-classification</a> and <a href="https://github.com/PyTorchLightning/lightning-flash" target="_blank" rel="noopener noreferrer">Lightning Flash</a></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="imdb-dataset"><strong>IMDB Dataset</strong><a class="hash-link" href="#imdb-dataset" title="Direct link to heading">â€‹</a></h3><p>IMDB dataset contains movie reviews, it is used for natural language processing, text analytics or sentiment classification such as positive or negative sentiment based on the text in the review. This dataset was originally created for <a href="https://www.aclweb.org/anthology/P11-1015.pdf" target="_blank" rel="noopener noreferrer">this paper</a></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="model-bert"><strong>Model <!-- -->(<!-- -->BERT<!-- -->)</strong><a class="hash-link" href="#model-bert" title="Direct link to heading">â€‹</a></h3><p>BERT<!-- -->(<a href="https://arxiv.org/abs/1810.04805" target="_blank" rel="noopener noreferrer">Bidirectional Encoder Representations from Transformers</a>)<!-- --> is a popular architecture used in NLP tasks. It works by applying bidirectional training of Transformer, a popular attention model, to language modeling.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="step-1-create-datastore">Step 1: Create Datastore<a class="hash-link" href="#step-1-create-datastore" title="Direct link to heading">â€‹</a></h2><p>It is fastest to upload zipped datasets from the Web UI. Grid supports uploading files in formats s/.zip, .tar or tar.gz/.zip, .tar and tar.gz/</p><p>The content of the archive is unzipped and unarchived when the datastore is created and presented for use in Session and Runs.</p><div class="codeBlockContainer_J+bg language-text theme-code-block"><div class="codeBlockContent_csEI text"><pre tabindex="0" class="prism-code language-text codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">https://pl-flash-data.s3.amazonaws.com/imdb.zip</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><img src="https://user-images.githubusercontent.com/13732925/121347438-319f5380-c8f5-11eb-9b61-be571f8aab1f.png" alt="new-datastore"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="step-2-start-a-new-run">Step 2: Start a new Run<a class="hash-link" href="#step-2-start-a-new-run" title="Direct link to heading">â€‹</a></h2><p>Take a look at this file if you are curious about the model. <a href="https://github.com/gridai/grid-text-classification/blob/main/train.py" target="_blank" rel="noopener noreferrer">https://github.com/gridai/grid-text-classification/blob/main/train.py</a></p><p>Paste the link to file in the New Run page.</p><p>Make sure to select the datastore created above. Note the mount directory. Make sure to add flags to your script.</p><p><img src="https://user-images.githubusercontent.com/13732925/121349841-f81c1780-c8f7-11eb-9dd6-3fe54d77c32a.png" alt="new run full 1"></p><p>Add the following flags to the script, then Run</p><div class="codeBlockContainer_J+bg language-text theme-code-block"><div class="codeBlockContent_csEI text"><pre tabindex="0" class="prism-code language-text codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">--gpus 1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--train_file /datastores/imdb-ds/imdb/train.csv \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--valid_file /datastores/imdb-ds/imdb/valid.csv \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--test_file /datastores/imdb-ds/imdb/test.csv \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--max_epochs 1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><img src="https://user-images.githubusercontent.com/13732925/121355055-7dee9180-c8fd-11eb-80bd-8e6f7add679a.png" alt="new run full 3"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="step-3-visualize-metrics">Step 3: Visualize Metrics<a class="hash-link" href="#step-3-visualize-metrics" title="Direct link to heading">â€‹</a></h2><p>As the model starts to train, metrics appear in the metrics section, make sure to select the Experiments to see metrics.</p><p>Tensorboard is also accessible</p><p><img src="https://user-images.githubusercontent.com/13732925/121350065-33b6e180-c8f8-11eb-9aba-bc836748c663.png" alt="train loss"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="step-4-download-artifacts">Step 4: Download Artifacts<a class="hash-link" href="#step-4-download-artifacts" title="Direct link to heading">â€‹</a></h2><p>Artifacts are available to download as well. You can choose to train for many epochs, create multiple checkpoints.</p><p><img src="https://user-images.githubusercontent.com/13732925/121350135-48937500-c8f8-11eb-8703-999161076d09.gif" alt="artifacts"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="bonus-run-in-cli">Bonus: Run in CLI<a class="hash-link" href="#bonus-run-in-cli" title="Direct link to heading">â€‹</a></h2><p>If you prefer to use CLI, use this command below</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> clone https://github.com/gridai/grid-text-classification.git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">cd</span><span class="token plain"> grid-text-classification</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">grid run </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --gpus </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --instance_type 1_v100_16gb </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --datastore_name imdb-ds </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      train.py </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --gpus </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --train_file /datastores/imdb-ds/imdb/train.csv </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --valid_file /datastores/imdb-ds/imdb/valid.csv  </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --test_file /datastores/imdb-ds/imdb/test.csv </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --max_epochs </span><span class="token number" style="color:#36acaa">1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/gridai/grid-docs/tree/main/docs/examples/nlp/text-classification.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2022-02-10T22:33:05.000Z">2/10/2022</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#goal" class="table-of-contents__link toc-highlight">Goal</a></li><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a><ul><li><a href="#imdb-dataset" class="table-of-contents__link toc-highlight"><strong>IMDB Dataset</strong></a></li><li><a href="#model-bert" class="table-of-contents__link toc-highlight"><strong>Model (BERT)</strong></a></li></ul></li><li><a href="#step-1-create-datastore" class="table-of-contents__link toc-highlight">Step 1: Create Datastore</a></li><li><a href="#step-2-start-a-new-run" class="table-of-contents__link toc-highlight">Step 2: Start a new Run</a></li><li><a href="#step-3-visualize-metrics" class="table-of-contents__link toc-highlight">Step 3: Visualize Metrics</a></li><li><a href="#step-4-download-artifacts" class="table-of-contents__link toc-highlight">Step 4: Download Artifacts</a></li><li><a href="#bonus-run-in-cli" class="table-of-contents__link toc-highlight">Bonus: Run in CLI</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row"><div class="footer__links text--left col-12 col-md-6"><div class="footer__links"><a href="https://twitter.com/gridai_" target="_blank" rel="noopener noreferrer" class="icon_hNi9 footer__link-item"><span class="fontawesome-brands-twitter_H+YA"></span></a><a href="https://www.youtube.com/channel/UCZYvMtnyzp0hrV2VXWUWL5w" target="_blank" rel="noopener noreferrer" class="icon_hNi9 footer__link-item"><span class="fontawesome-brands-youtube_AMCj"></span></a><a href="https://www.linkedin.com/company/grid-ai" target="_blank" rel="noopener noreferrer" class="icon_hNi9 footer__link-item"><span class="fontawesome-brands-linkedin_qvBC"></span></a><a href="https://www.facebook.com/grid.ai.1" target="_blank" rel="noopener noreferrer" class="icon_hNi9 footer__link-item"><span class="fontawesome-brands-facebook_dvJl"></span></a><a href="https://join.slack.com/t/gridai-community/shared_invite/zt-ozqiwuif-UYK6rZGVmTTpMfPcVSdicg" target="_blank" rel="noopener noreferrer" class="icon_hNi9 footer__link-item"><span class="fontawesome-brands-slack_b9n1"></span></a><a href="https://grid.ai" target="_blank" rel="noopener noreferrer" class="icon_hNi9 footer__link-item"><span class="fontawesome-solid-globe_5L6P"></span></a><a href="mailto:support@grid.ai" target="_blank" rel="noopener noreferrer" class="icon_hNi9 footer__link-item"><span class="fontawesome-solid-envelope_P+u9"></span></a></div></div><div class="footer__bottom text--right col-12 col-md-6"><div class="footer__copyright">Copyright Â© 2022 GRID AI</div></div></div></div></footer></div>
<script src="/assets/js/runtime~main.007a586e.js"></script>
<script src="/assets/js/main.5ecc84b8.js"></script>
</body>
</html>